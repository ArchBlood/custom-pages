/**
 * plugin.js
 *
 * @link https://www.humhub.org/
 * @copyright Copyright (c) 2022 HumHub GmbH & Co. KG
 * @license https://www.humhub.com/licences
 * @author Lucas Bartholemy <lucas@bartholemy.com>
 */
tinymce.PluginManager.add("humhubtrigger",(function(e,n){const t=e.getParam("humhubTrigger"),r=()=>t.selector&&$(t.selector).length,i=()=>r&&$(t.selector).data("humhubFileUpload")?$(t.selector).data("humhubFileUpload"):null;e.ui.registry.addButton("humhubtrigger",{icon:t.icon,text:t.text,onAction:function(){r&&$(t.selector).trigger(t.event)}}),i()&&i().on("humhub:file:uploadEnd",(function(n,t){t._response.result.files instanceof Array&&t._response.result.files.length&&e.insertContent(function(e){let n="\n";return e.forEach((function(e){void 0!==e.url&&void 0!==e.mimeType&&(0===e.mimeType.indexOf("image/")?n+='<img src="'+e.url+'" class="img-responsive">':n+='<a href="'+e.url+'" target="_blank">'+(void 0===e.name?e.url:e.name)+"</a>",n+="\n")})),n}(t._response.result.files))}))}));
